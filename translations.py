# translations.py

translations = {
    'en': {
        'app_title': 'Excel Processor',
        'drag_drop_text': 'Drag & Drop Excel Files Here\nor Click to Browse',
        'select_excel_files': 'Select Excel Files',
        'excel_files_filter': 'Excel Files (*.xlsx *.xlsm *.xls)',
        'loaded_files': 'Loaded Files',
        'processed_files': 'Processed Files',
        'ready': 'Ready',
        'header_color': 'Header Color:',
        'clear_files': 'Clear Files',
        'process_files': 'Process Files',
        'processing_resumed': 'Processing resumed...',
        'processing_paused': 'Processing paused',
        'stopping': 'Stopping...',
        'stop_processing_title': 'Stop Processing',
        'stop_processing_confirm': 'Are you sure you want to stop processing?',
        'files_loaded': '{count} files loaded',
        'processing': 'Processing: {filename}',
        'sheets_progress': 'Sheets: {processed}/{total}',
        'summary': '<b>Summary:</b><br>',
        'total_files': 'Total files: {total}<br>',
        'success': '\u2713 Success: {count}<br>',
        'failed': '\u2717 Failed: {count}<br>',
        'output_folder': '<br>Output folder: <a href="{folder}">Open Deeva folder</a>',
        'processing_stopped': 'Processing stopped by user',
        'completed': 'Completed: {success} success, {failed} failed',
        'menu_file': 'File',
        'menu_clear_all': 'Clear All',
        'menu_exit': 'Exit',
        'menu_help': 'Help',
        'menu_check_updates': 'Check for Updates',
        'menu_about': 'About',
        'menu_language': 'Language',
        'lang_en': 'English',
        'lang_ru': 'Русский',
        'about_title': 'About',
        'about_text': 'Excel Processor v{version}\n\nA tool for duplicating Excel rows with headers\n\nGitHub: https://github.com/Slipfaith/DM',
        'update_available_title': 'Update Available',
        'update_available_text': 'Version {latest} is available!',
        'current_version': 'Current version: {version}',
        'new_version': 'New version: {version}',
        'update_prompt': 'Would you like to download and install it?',
        'update_downloaded_title': 'Update Downloaded',
        'update_downloaded_text': 'Update downloaded successfully!',
        'update_restart_text': 'The application will now close to install the update.\nPlease restart the application after installation.',
        'no_updates_title': 'No Updates',
        'no_updates_text': 'You are using the latest version ({version})',
        'update_error_title': 'Update Check Failed',
        'no_exe_error': 'No executable file found in the release',
        'auto_update_exe_only': 'Auto-update only works with compiled exe files',
        'downloading_update': 'Downloading update...',
        'cancel': 'Cancel',
        'updating': 'Updating',
        'download_failed': 'Download failed: {error}',
        'could_not_determine': 'Could not determine latest version',
        'error_checking_updates': 'Error checking for updates: {error}'
    },
    'ru': {
        'app_title': 'Обработчик Excel',
        'drag_drop_text': 'Перетащите файлы Excel сюда\nили нажмите для выбора',
        'select_excel_files': 'Выберите файлы Excel',
        'excel_files_filter': 'Файлы Excel (*.xlsx *.xlsm *.xls)',
        'loaded_files': 'Загруженные файлы',
        'processed_files': 'Обработанные файлы',
        'ready': 'Готово',
        'header_color': 'Цвет заголовка:',
        'clear_files': 'Очистить список',
        'process_files': 'Обработать файлы',
        'processing_resumed': 'Обработка продолжена...',
        'processing_paused': 'Обработка приостановлена',
        'stopping': 'Остановка...',
        'stop_processing_title': 'Остановить обработку',
        'stop_processing_confirm': 'Вы уверены, что хотите остановить обработку?',
        'files_loaded': 'Загружено файлов: {count}',
        'processing': 'Обработка: {filename}',
        'sheets_progress': 'Листы: {processed}/{total}',
        'summary': '<b>Сводка:</b><br>',
        'total_files': 'Всего файлов: {total}<br>',
        'success': '\u2713 Успешно: {count}<br>',
        'failed': '\u2717 Ошибок: {count}<br>',
        'output_folder': '<br>Папка с результатами: <a href="{folder}">Открыть папку Deeva</a>',
        'processing_stopped': 'Обработка остановлена пользователем',
        'completed': 'Завершено: {success} успешно, {failed} с ошибками',
        'menu_file': 'Файл',
        'menu_clear_all': 'Очистить все',
        'menu_exit': 'Выход',
        'menu_help': 'Справка',
        'menu_check_updates': 'Проверить обновления',
        'menu_about': 'О программе',
        'menu_language': 'Язык',
        'lang_en': 'English',
        'lang_ru': 'Русский',
        'about_title': 'О программе',
        'about_text': 'Excel Processor v{version}\n\nИнструмент для дублирования строк Excel с заголовками\n\nGitHub: https://github.com/Slipfaith/DM',
        'update_available_title': 'Доступно обновление',
        'update_available_text': 'Доступна версия {latest}!',
        'current_version': 'Текущая версия: {version}',
        'new_version': 'Новая версия: {version}',
        'update_prompt': 'Загрузить и установить сейчас?',
        'update_downloaded_title': 'Обновление загружено',
        'update_downloaded_text': 'Обновление успешно загружено!',
        'update_restart_text': 'Приложение будет закрыто для установки обновления.\nПожалуйста, перезапустите его после установки.',
        'no_updates_title': 'Обновлений нет',
        'no_updates_text': 'Вы используете последнюю версию ({version})',
        'update_error_title': 'Ошибка проверки обновления',
        'no_exe_error': 'В релизе не найден исполняемый файл',
        'auto_update_exe_only': 'Автообновление доступно только для exe-файлов',
        'downloading_update': 'Загрузка обновления...',
        'cancel': 'Отмена',
        'updating': 'Обновление',
        'download_failed': 'Сбой загрузки: {error}',
        'could_not_determine': 'Не удалось определить последнюю версию',
        'error_checking_updates': 'Ошибка проверки обновлений: {error}'
    }
}

_current_language = 'en'


def set_language(lang: str):
    global _current_language
    if lang in translations:
        _current_language = lang


def tr(key: str, **kwargs) -> str:
    text = translations.get(_current_language, {}).get(key,
                     translations['en'].get(key, key))
    if kwargs:
        try:
            return text.format(**kwargs)
        except Exception:
            return text
    return text
